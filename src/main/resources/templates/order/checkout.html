<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{layout/user :: content('BookSeat Page', ~{this :: .container})}">

<section class="container">
	<div class="order-container">
		<div class="order" style="margin-top: 50;">
			<img class="order__images" style="position: absolute; left: 400;  " alt=''
				th:src="@{/user/images/tickets.png}">
			<p class="order__title">Book a ticket <br><span class="order__descript">and have fun movie time</span></p>
			<div class="order__control">

			</div>
		</div>
	</div>
	<div class="order-step-area" style="margin-top: 130;">
		<div class="order-step first--step order-step--disable ">1. What &amp; Where &amp; When</div>
		<div class="order-step second--step order-step--disable">2. Choose a sit</div>
		<div class="order-step third--step">3. Check out</div>
	</div>

	<div class="col-sm-12">
		<div class="checkout-wrapper" id="totalList">
			<h2 class="page-heading">price</h2>
			<ul class="book-result">
				<li class="book-result__item">Tickets: <span class="book-result__count booking-ticket"
						id="ticketCount"></span></li>

				<li class="book-result__item">One item price: <span class="book-result__count booking-price"
						id="showPrice"></span>
				</li>
				<li class="book-result__item">Total Seat: <span class="book-result__count booking-cost"
						id="ticketTotalPrice"></span></li>
				<li class="book-result__item">The total amount payable: <span class="book-result__count booking-cost"
						id="totalCost"></span></li>

			</ul>
			<h2 class="page-heading">food</h2>
			<ul class="book-result" id="foodList">

			</ul>
			<!-- total -->
			<ul class="book-result" id="foodTotalList">
				<li class="book-result__item">Total food cost: <span class="book-result__count booking-cost"
						id="foodTotalCost"></span></li>
			</ul>


			<ul class="book-result">

			</ul>
			<!-- vnpay -->

		</div>

		<div class="order">
			<a href="book-final.html" class="btn btn-md btn--warning btn--wide">buy now</a>
			<script th:inline="javascript">

				const showId = JSON.parse(localStorage.getItem("showId"))
				const foods = JSON.parse(localStorage.getItem("foods"))
				const seatIds = JSON.parse(localStorage.getItem("seatIds"))
				const showPrice = JSON.parse(localStorage.getItem("showPrice"))
				console.log("book-final")
				console.log("Show ID :" + showId)
				console.log("Foods :")
				console.log(foods)
				console.log("Seat :")
				console.log(seatIds)
				console.log("Seat price :" + showPrice)

				document.getElementById('ticketCount').textContent = seatIds ? seatIds.length : 0;
				document.getElementById('showPrice').textContent = "$" + showPrice;

				// Calculate and display total ticket cost
				const totalCostElement = document.getElementById('totalCost');
				const ticketCount = seatIds ? seatIds.length : 0;
				const ticketTotalPrice = ticketCount * showPrice;
				console.log("ticketTotalPrice :" + ticketTotalPrice)
				document.getElementById('ticketTotalPrice').textContent = "$" + ticketTotalPrice;
				// Display food information and calculate total food cost if available
				const foodListElement = document.getElementById('foodList');
				const foodTotalCostElement = document.getElementById('foodTotalCost');
				let foodTotalPrice = 0;
				if (foods && foods.length > 0) {
					foods.forEach(function (food) {
						const foodItem = document.createElement('div');
						foodItem.className = "food-item";
						const foodQuantity = food.quantity || 1; // Default quantity is 1 if not specified
						const foodPrice = parseFloat(food.price);
						const itemTotalPrice = foodQuantity * foodPrice;
						foodTotalPrice += itemTotalPrice;

						foodItem.innerHTML = "<li class='food-item'><div class='food-name'>"
							+ food.name + "</div><div class='food-quantity'>Quantity: "
							+ foodQuantity + "</div><div class='food-price'>One item price: <span class='book-result__count booking-price' id='showPrice'>$" + showPrice + "</span></div><div class='food-total'>Total Price: $" + itemTotalPrice.toFixed(2) + "</div></li>";


						foodListElement.appendChild(foodItem);
					});
				}
				foodTotalCostElement.textContent = "$" + foodTotalPrice;

				// Calculate and display total cost including ticket and food
				const totalCostBill = ticketTotalPrice + foodTotalPrice;
				totalCostElement.textContent = "$" + totalCostBill;

			</script>
		</div>

	</div>

</section>

</html>